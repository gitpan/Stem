
package Stem::LoadTest ;

use strict ;

use YAML ;


my $attr_spec = [


	{
		'name'		=> 'reg_name',
		'help'		=> <<HELP,
Name this Cell was registered with.
HELP
	},

	{
		'name'		=> 'max_loads_per_hub',
		'default'	=> 1,
		'help'		=> <<HELP,
Maximum number of load processes per Hub
HELP
	},
	{
		'name'		=> 'max_sites_per_hub',
		'default'	=> 10,
		'help'		=> <<HELP,
Maximum number of active Napa::Site Cells per Hub
HELP
	},
] ;


sub new {

	my( $class ) = shift ;

	my $self = Stem::Class::parse_args( $attr_spec, @_ ) ;
	return $self unless ref $self ;

	return $self ;
}

sub go_cmd {

	my( $self ) = @_ ;

#	$self->trigger_fetch_processes() ;

	return "Load Started" ;
}

sub trigger_fetch_processes {

	my( $self ) = @_ ;

	my $load_addr = $self->{'load_addr'} ;

	foreach ( 1 .. $self->{'max_loads_per_hub'} ) {

		my $trig_msg = Stem::Msg->new(
			'to'	=> $load_addr,
			'from'	=> $self->{'reg_name'},
			'type'	=> 'cmd',
			'cmd'	=> 'cell_trigger',
		) ;

		$trig_msg->dispatch() ;
	}
}

1 ;
